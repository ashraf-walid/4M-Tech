import "./globals.css";
import StoreInitializer from '@/store/initializeStore';

export const metadata = {
  title: "Buy Tech Store",
  description: "Generated by Ashraf",
};

export default function RootLayout({ children }) {
  return (
    <html lang="ar" dir="rtl">
      <head>
        <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-icon.png"/>
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/icon1.png"/>
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/icon1.png" />
        <link rel="icon" href="/favicon_io/icon0.svg" />
        <link rel="manifest" href="/favicon_io/manifest.json" />
      </head>
      <body>
        <StoreInitializer />
        {children}
      </body>
    </html>
  );
}

#################################################################################################

import SaleSection from "@/components/Home/SaleSection";
import NewsletterSection from "@/components/Home/NewsletterSection";
import NewProductSection from "@/components/Home/NewProductSection";
import BestSeller from "@/components/Home/BestSeller";
import Header from "@/components/Header/index";
import Footer from "@/components/footer/Footer";

export default function Home() {

  return (
    <>
      <Header/>
      <CategorySection />
      <NewProductSection />
      <SaleSection />
      <BestSeller />
      <NewsletterSection />
      <Footer/>
    </>
  )
}

#################################################################################################

"use client";

import { ChevronLeft, ChevronRight } from "lucide-react";
import ProductCard from "@/components/ProductCard";
import { useRef, useState, useEffect } from "react";
import useCartStore from "@/store/cartStore";
import useProductsStore from "@/store/productsStore";
import Loading from "@/components/feedback/Loading";
import ErrorState from "@/components/feedback/ErrorState";

const BestSeller = () => {
  const sliderRef = useRef(null);
  const [canScrollLeft, setCanScrollLeft] = useState(false);
  const [canScrollRight, setCanScrollRight] = useState(false);
  const [scrollAmount, setScrollAmount] = useState(320);

  const { getBestSellerProducts, ensureProductsLoaded, loading, error } = useProductsStore();

  ensureProductsLoaded();

  const products = getBestSellerProducts();

  const { cartItem } = useCartStore();
    
  // Responsive scroll amount
  useEffect(() => {
    function updateScrollAmount() {
      if (sliderRef.current) {
        const width = sliderRef.current.offsetWidth;
        setScrollAmount(width < 500 ? width * 0.8 : 320);
      }
    }
    updateScrollAmount();
    window.addEventListener("resize", updateScrollAmount);
    return () => window.removeEventListener("resize", updateScrollAmount);
  }, []);

  // Smart scroll button logic
  useEffect(() => {
    function checkScroll() {
      if (!sliderRef.current) return;
      setCanScrollLeft(sliderRef.current.scrollLeft > 0);
      setCanScrollRight(
        sliderRef.current.scrollLeft + sliderRef.current.offsetWidth <
          sliderRef.current.scrollWidth - 1
      );
    }
    checkScroll();
    sliderRef.current?.addEventListener("scroll", checkScroll);
    window.addEventListener("resize", checkScroll);
    return () => {
      sliderRef.current?.removeEventListener("scroll", checkScroll);
      window.removeEventListener("resize", checkScroll);
    };
  }, []);

  const scroll = (direction) => {
    if (!sliderRef.current) return;
    const { scrollLeft } = sliderRef.current;
    sliderRef.current.scrollTo({
      left:
        direction === "left"
          ? scrollLeft - scrollAmount
          : scrollLeft + scrollAmount,
      behavior: "smooth",
    });
  };

  if (loading) return <Loading />;
  if (error) return <ErrorState message={error} />;

  return (
    <section className="w-full py-20 bg-white">
      <div className="w-full lg:w-[82%] mx-auto px-4 py-10">
        {/* Container */}
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold text-[#393405] mb-4 leading-[120%] tracking-tight relative inline-block">
            <span className="relative z-10">ÿ£ŸÅÿ∂ŸÑ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</span>
            <span className="absolute left-1/2 -translate-x-1/2 bottom-0 w-[90%] h-3 bg-gradient-to-r from-yellow-200 via-yellow-300 to-yellow-100 rounded-lg opacity-70 -z-0"></span>
          </h2>
        </div>
        {/* Slider */}
        <div className="relative">
          <button
            aria-label="Scroll left"
            className="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white border border-gray-200 shadow hover:bg-yellow-100 rounded-full p-2 transition"
            onClick={() => scroll("left")}
          >
            <ChevronLeft className="text-xl text-[#393405]" />
          </button>
          {/* content */}
          <div
            ref={sliderRef}
            className="flex gap-6 overflow-x-auto scroll-smooth px-2 py-6"
            style={{
              scrollSnapType: "x mandatory",
              willChange: "scroll-position",
              scrollbarWidth: "none" /* Firefox */,
              msOverflowStyle: "none" /* IE and Edge */,
            }}
          >
            <style jsx>{`
              div::-webkit-scrollbar {
                display: none; /* Chrome, Safari and Opera */
              }
            `}</style>
            {Array.isArray(products)
              ? products.map((product, index) => {
                  const quantity = cartItem[product._id] || 0;
                  const isInCart = quantity > 0;
                  const getProductQuantity = (_id) => cartItem[_id] || 0;
                  return (
                    <div
                      key={product._id}
                      className="min-w-[280px] max-w-[320px] flex-shrink-0 transition-shadow duration-300 hover:shadow-2xl hover:-translate-y-1.5"
                      style={{ scrollSnapAlign: "start" }}
                    >
                      <ProductCard
                        product={product}
                        isInCart={isInCart}
                        getProductQuantity={getProductQuantity}
                      />
                    </div>
                  );
                })
              : null}
          </div>
          <button
            aria-label="Scroll right"
            className="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white border border-gray-200 shadow hover:bg-yellow-100 rounded-full p-2 transition"
            onClick={() => scroll("right")}
            style={{ display: canScrollRight ? "block" : "none" }}
          >
            <ChevronRight className="text-xl text-[#393405]" />
          </button>
        </div>
      </div>
    </section>
  );
};

export default BestSeller;

#################################################################################################

"use client";

import { useState, useEffect, useRef, useMemo } from "react";
import { ChevronRight, ChevronLeft } from "lucide-react";
import ProductCard from "@/components/ProductCard";
import useCartStore from "@/store/cartStore";
import useProductsStore from "@/store/productsStore";
import Loading from "@/components/feedback/Loading";
import ErrorState from "@/components/feedback/ErrorState";

const NewProductSection = () => {
  const [currentSlide, setCurrentSlide] = useState(0);
  const [isAutoPlaying, setIsAutoPlaying] = useState(true);
  const { getNewProducts, ensureProductsLoaded, loading, error } =
    useProductsStore();

  const { cartItem } = useCartStore();
  const timerRef = useRef(null);
  const [isDocumentVisible, setIsDocumentVisible] = useState(true);
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    ensureProductsLoaded();
  }, [ensureProductsLoaded]);

  const products = useMemo(() => {
    const list = getNewProducts?.() ?? [];
    return Array.isArray(list) ? list : [];
  }, [getNewProducts]);

  const nextSlide = () => {
    setCurrentSlide((prev) => (prev + 1) % products.length);
    resetTimer();
  };

  const prevSlide = () => {
    setCurrentSlide((prev) => (prev - 1 + products.length) % products.length);
    resetTimer();
  };

  const SLIDE_INTERVAL = 2000;

  const resetTimer = () => {
    if (timerRef.current) {
      clearInterval(timerRef.current);
    }
    if (
      isAutoPlaying &&
      isDocumentVisible &&
      !prefersReducedMotion &&
      products.length > 1
    ) {
      timerRef.current = setInterval(() => {
        setCurrentSlide((prev) => (prev + 1) % products.length);
      }, SLIDE_INTERVAL);
    }
  };

  useEffect(() => {
    if (
      isAutoPlaying &&
      isDocumentVisible &&
      !prefersReducedMotion &&
      products.length > 1
    ) {
      timerRef.current = setInterval(() => {
        setCurrentSlide((prev) => (prev + 1) % products.length);
      }, SLIDE_INTERVAL);
    }

    return () => {
      if (timerRef.current) {
        clearInterval(timerRef.current);
      }
    };
  }, [isAutoPlaying, isDocumentVisible, prefersReducedMotion, products.length]);

  // Pause when tab is hidden / resume when visible
  useEffect(() => {
    const handleVisibility = () => {
      setIsDocumentVisible(!document.hidden);
    };
    document.addEventListener("visibilitychange", handleVisibility);
    handleVisibility();
    return () =>
      document.removeEventListener("visibilitychange", handleVisibility);
  }, []);

  // Respect prefers-reduced-motion: reduce
  useEffect(() => {
    if (typeof window === "undefined" || !window.matchMedia) return;
    const mql = window.matchMedia("(prefers-reduced-motion: reduce)");
    const update = () => setPrefersReducedMotion(!!mql.matches);
    update();
    try {
      mql.addEventListener("change", update);
      return () => mql.removeEventListener("change", update);
    } catch {
      // Safari fallback
      mql.addListener(update);
      return () => mql.removeListener(update);
    }
  }, []);

  const handleMouseEnter = () => {
    setIsAutoPlaying(false);
    if (timerRef.current) {
      clearInterval(timerRef.current);
    }
  };

  const handleMouseLeave = () => {
    setIsAutoPlaying(true);
    resetTimer();
  };

  const goToSlide = (index) => {
    setCurrentSlide(index);
    resetTimer();
  };

  if (loading) return <Loading />;
  if (error) return <ErrorState message={error} />;
  if (!products || products.length === 0) {
    return (
      <section
        className="w-full py-8 bg-white overflow-hidden"
        aria-label="New products carousel"
      >
        <div className="max-w-[1400px] mx-auto">
          <div className="text-center mb-8">
            <h2 className="text-2xl font-bold text-[#393405]">
              ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ©
            </h2>
          </div>
        </div>
      </section>
    );
  }

  const handleKeyDown = (e) => {
    if (products.length < 1) return;
    if (e.key === "ArrowLeft") {
      e.preventDefault();
      prevSlide();
    } else if (e.key === "ArrowRight") {
      e.preventDefault();
      nextSlide();
    } else if (e.key === " ") {
      e.preventDefault();
      setIsAutoPlaying((p) => !p);
      resetTimer();
    }
  };

  return (
    <section
      className="w-full py-8 bg-white overflow-hidden"
      aria-roledescription="carousel"
      aria-label="New products carousel"
      tabIndex={0}
      onKeyDown={handleKeyDown}
    >
      <div className="max-w-[1400px] mx-auto">
        <div className="text-center mb-16">
          <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold text-[#393405] mb-2 sm:mb-6 md:mb-8 lg:mb-10 leading-[120%] tracking-tight relative inline-block">
            <span className="relative z-10">ÿßÿ≠ÿØÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
            <span className="absolute left-1/2 -translate-x-1/2 bottom-0 w-[90%] h-3 bg-gradient-to-r from-yellow-200 via-yellow-300 to-yellow-100 rounded-lg opacity-70 -z-0"></span>
          </h2>
        </div>
        <div className="relative px-3 sm:px-8 py-1 md:py-4 lg:py-8">
          <button
            className="absolute left-4 top-1/2 bg-[#fdf407] cursor-pointer -translate-y-1/2 z-10 w-12 h-12 rounded-full  shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-100 transition-colors duration-200"
            onClick={prevSlide}
            disabled={products.length < 2}
            aria-disabled={products.length < 2}
            aria-label="ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ≥ÿßÿ®ŸÇ"
          >
            <ChevronLeft className=" button-icon" />
          </button>
          {/* Product Card */}
          <div className="relative h-[600px] flex items-center justify-center">
            {products.map((product, index) => {
              const quantity = cartItem[product._id] || 0;
              const isInCart = quantity > 0;
              const getProductQuantity = (_id) => cartItem[_id] || 0;
              return (
                <div
                  key={product._id}
                  className={`absolute top-1/2 left-1/2 transition-all duration-700 ease-in-out`}
                  onMouseEnter={handleMouseEnter}
                  onMouseLeave={handleMouseLeave}
                  style={{
                    transform:
                      index === currentSlide
                        ? "translate(-50%, -50%) scale(1)"
                        : index ===
                          (currentSlide - 1 + products.length) % products.length
                        ? "translate(-150%, -50%) scale(0.75)"
                        : index === (currentSlide + 1) % products.length
                        ? "translate(50%, -50%) scale(0.75)"
                        : "translate(-50%, -50%) scale(0.8)",
                    zIndex:
                      index === currentSlide
                        ? 30
                        : index ===
                            (currentSlide - 1 + products.length) %
                              products.length ||
                          index === (currentSlide + 1) % products.length
                        ? 20
                        : 1,
                    opacity: index === currentSlide ? 1 : 0.3,
                    pointerEvents: index === currentSlide ? "auto" : "none",
                    visibility:
                      index === currentSlide ||
                      index ===
                        (currentSlide - 1 + products.length) %
                          products.length ||
                      index === (currentSlide + 1) % products.length
                        ? "visible"
                        : "hidden",
                  }}
                >
                  <ProductCard
                    product={product}
                    isInCart={isInCart}
                    getProductQuantity={getProductQuantity}
                  />
                </div>
              );
            })}
          </div>
          <button
            className="absolute right-4 top-1/2 bg-[#fdf407] cursor-pointer -translate-y-1/2 z-10 w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-100 transition-colors duration-200"
            onClick={nextSlide}
            disabled={products.length < 2}
            aria-disabled={products.length < 2}
            aria-label="ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ™ÿßŸÑŸä"
          >
            <ChevronRight className="button-icon" />
          </button>
        </div>

        {/* Pagination indicators */}
        <div className="flex justify-center mt-10 sm:mt-20 space-x-2">
          {products.map((_, index) => (
            <button
              key={index}
              onClick={() => goToSlide(index)}
              className={`w-3 h-3 rounded-full transition-colors duration-200 cursor-pointer
                  ${index === currentSlide ? "bg-[#fdf407]" : "bg-gray-300"}`}
              aria-current={index === currentSlide ? "true" : undefined}
              aria-label={`ÿßŸÜÿ™ŸÇŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ¥ÿ±Ÿäÿ≠ÿ© ${index + 1}`}
            />
          ))}
        </div>
      </div>
    </section>
  );
};

export default NewProductSection;

// "use client";

// import { useState, useEffect, useRef } from "react";
// import { ChevronRight, ChevronLeft } from "lucide-react";
// import { formatPrice } from "@/utils/formatPrice";
// import ProductCard from "@/components/ProductCard";
// import useCartStore from "@/store/cartStore";
// import { Trash2 } from "lucide-react";
// import Image from "next/image";
// import useProductsStore from "@/store/productsStore";
// import Loading from "@/components/feedback/Loading";
// import ErrorState from "@/components/feedback/ErrorState";
// import Link from "next/link";

// const NewProductSection = () => {
//   const [currentSlide, setCurrentSlide] = useState(0);
//   const [isAutoPlaying, setIsAutoPlaying] = useState(true);
//   const { getNewProducts, ensureProductsLoaded, loading, error } = useProductsStore();

//   const { cartItem, addToCart, removeFromCart } = useCartStore();
//   const timerRef = useRef(null);

//   useEffect(() => {
//     ensureProductsLoaded();
//   }, [ensureProductsLoaded]);

//   const products = getNewProducts();

//   const nextSlide = () => {
//     setCurrentSlide((prev) => (prev + 1) % products.length);
//     resetTimer();
//   };

//   const prevSlide = () => {
//     setCurrentSlide((prev) => (prev - 1 + products.length) % products.length);
//     resetTimer();
//   };

//   const SLIDE_INTERVAL = 2000;

//   const resetTimer = () => {
//     if (timerRef.current) {
//       clearInterval(timerRef.current);
//     }
//     if (isAutoPlaying) {
//       timerRef.current = setInterval(() => {
//         setCurrentSlide((prev) => (prev + 1) % products.length);
//       }, SLIDE_INTERVAL);
//     }
//   };

//   useEffect(() => {
//     if (isAutoPlaying) {
//       timerRef.current = setInterval(() => {
//         setCurrentSlide((prev) => (prev + 1) % products.length);
//       }, SLIDE_INTERVAL);
//     }

//     return () => {
//       if (timerRef.current) {
//         clearInterval(timerRef.current);
//       }
//     };
//   }, [isAutoPlaying, products.length]);

//   const handleMouseEnter = () => {
//     setIsAutoPlaying(false);
//     if (timerRef.current) {
//       clearInterval(timerRef.current);
//     }
//   };

//   const handleMouseLeave = () => {
//     setIsAutoPlaying(true);
//     resetTimer();
//   };

//   const goToSlide = (index) => {
//     setCurrentSlide(index);
//     resetTimer();
//   };

//   if (loading) return <Loading />;
//   if (error) return <ErrorState message={error} />;

//   return (
//     <section className="w-full py-8 bg-white overflow-hidden">
//       <div className="max-w-[1400px] mx-auto">
//         <div className="text-center mb-16">
//           <h2 className="text-3xl md:text-4xl lg:text-5xl font-bold text-[#393405] mb-2 sm:mb-6 md:mb-8 lg:mb-10 leading-[120%] tracking-tight relative inline-block">
//             <span className="relative z-10">ÿßÿ≠ÿØÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
//             <span className="absolute left-1/2 -translate-x-1/2 bottom-0 w-[90%] h-3 bg-gradient-to-r from-yellow-200 via-yellow-300 to-yellow-100 rounded-lg opacity-70 -z-0"></span>
//           </h2>
//         </div>
//         <div className="relative px-3 sm:px-8 py-1 md:py-4 lg:py-8">
//           <button
//             className="absolute left-4 top-1/2 bg-[#fdf407] cursor-pointer -translate-y-1/2 z-10 w-12 h-12 rounded-full  shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-100 transition-colors duration-200"
//             onClick={prevSlide}
//             aria-label="ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ≥ÿßÿ®ŸÇ"
//           >
//             <ChevronLeft className=" button-icon" />
//           </button>
//           {/* Product Card */}
//           <div className="relative h-[600px] flex items-center justify-center">
//             {products.map((product, index) => {
//               const quantity = cartItem[product._id] || 0;
//               const isInCart = quantity > 0;
//               const getProductQuantity = (_id) => cartItem[_id] || 0;
//               return (
//                 <div
//                   key={product._id}
//                   className={`absolute top-1/2 left-1/2 transition-all duration-700 ease-in-out`}
//                   onMouseEnter={handleMouseEnter}
//                   onMouseLeave={handleMouseLeave}
//                   style={{
//                     transform:
//                       index === currentSlide
//                         ? "translate(-50%, -50%) scale(1)"
//                         : index ===
//                           (currentSlide - 1 + products.length) % products.length
//                         ? "translate(-150%, -50%) scale(0.75)"
//                         : index === (currentSlide + 1) % products.length
//                         ? "translate(50%, -50%) scale(0.75)"
//                         : "translate(-50%, -50%) scale(0.8)",
//                     zIndex:
//                       index === currentSlide
//                         ? 30
//                         : index ===
//                             (currentSlide - 1 + products.length) %
//                               products.length ||
//                           index === (currentSlide + 1) % products.length
//                         ? 20
//                         : 1,
//                     opacity: index === currentSlide ? 1 : 0.3,
//                     pointerEvents: index === currentSlide ? "auto" : "none",
//                     visibility:
//                       index === currentSlide ||
//                       index ===
//                         (currentSlide - 1 + products.length) %
//                           products.length ||
//                       index === (currentSlide + 1) % products.length
//                         ? "visible"
//                         : "hidden",
//                   }}
//                 >
//                   <div
//                     className={`w-[350px] sm:w-[400px] md:w-[430px] lg:w-[450px]  bg-white rounded-2xl overflow-hidden shadow-lg transition-all duration-300 ${
//                       index === currentSlide ? "shadow-2xl" : ""
//                     }`}
//                   >
//                     <Link href={`/ProductDetailsPage/${product._id}`}>
//                       <div className="relative h-60 md:h-80 bg-gradient-to-br from-gray-100 to-gray-200 overflow-hidden">
//                         {product.badge && (
//                           <span className="absolute top-5 left-5 bg-[#fdf407] text-[#393405] px-4 py-2 rounded-lg text-xs font-bold shadow-md z-10">
//                             {product.badge}
//                           </span>
//                         )}
//                         {product.discount > 0 && (
//                           <span className="absolute top-5 right-5 bg-red-600 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md z-10">
//                             {product.discount}% ÿÆÿµŸÖ
//                           </span>
//                         )}
//                         <div
//                           className={`w-full h-full transition-transform duration-500 ${
//                             index === currentSlide ? "scale-[1.02]" : "scale-100"
//                           }`}
//                         >
//                           <Image
//                             src={product.image}
//                             alt={product.name}
//                             width={400}
//                             height={400}
//                             className="w-full h-full object-contain"
//                           />
//                         </div>
//                       </div>
//                     </Link>
//                     <div className="p-8">
//                       <span className="sm:text-sm text-xs font-semibold text-[#7c760f] uppercase tracking-wider">
//                         {product.category}
//                       </span>
//                       <h3 className="sm:text-2xl text-xl font-bold text-[#393405] mt-2 mb-3">
//                         {product.name}
//                       </h3>
//                       {(() => {
//                         const s = product?.specs;
//                         let specsList = Array.isArray(s) ? s : [];
//                         if (!Array.isArray(s)) {
//                           const gpu = s?.gpu;
//                           const ram = s?.ram;
//                           const storage = s?.storage;
//                           const screen = s?.screen;
//                           if (gpu?.brand || gpu?.model) {
//                             specsList.push(`${gpu?.brand ?? ""} ${gpu?.model ?? ""}`.trim());
//                           }
//                           if (ram?.size || ram?.type) {
//                             specsList.push(`${ram?.size ?? ""}${ram?.unit ?? ""} ${ram?.type ?? ""}`.trim());
//                           }
//                           if (storage?.capacity || storage?.type) {
//                             specsList.push(`${storage?.capacity ?? ""}${storage?.unit ?? ""} ${storage?.type ?? ""}`.trim());
//                           }
//                           if (screen?.size || screen?.resolution) {
//                             specsList.push(`${screen?.size ?? ""}${screen?.unit ?? ""} ${screen?.resolution ?? ""}`.trim());
//                           }
//                         }
//                         if (Array.isArray(product?.extraFeatures)) {
//                           specsList = [...specsList, ...product.extraFeatures];
//                         }
//                         if (specsList.length === 0) return null;
//                         return (
//                           <ul className="space-y-1 mb-3">
//                             {specsList.map((spec, i) => (
//                               <li key={i} className="flex items-start leading-4">
//                                 <span className="text-green-600 ml-2"> ‚úì </span>
//                                 <span className="text-[#3b3934] text-xs sm:text-sm leading-4">
//                                   {spec}
//                                 </span>
//                               </li>
//                             ))}
//                           </ul>
//                         );
//                       })()}
//                       <div className="flex flex-wrap gap-1 mb-2">
//                         {product.ports &&
//                           product.ports.map((port, i) => (
//                             <span
//                               key={i}
//                               className="bg-gray-100 text-gray-700 px-1 py-[2px] rounded text-xs"
//                             >
//                               {port}
//                             </span>
//                           ))}
//                       </div>
//                       <div className="flex items-center justify-between">
//                         <span className="sm:text-2xl text-xl font-bold text-[#393405]">
//                           {product.price}
//                         </span>
//                         {isInCart ? (
//                           <div className="flex items-center justify-between bg-[#fdf407] rounded-lg overflow-hidden shadow-md">
//                             <button
//                               onClick={() => addToCart(product._id)}
//                               className="px-2 py-1 hover:text-gray-700 transition-colors duration-200 font-bold text-black cursor-pointer"
//                               aria-label="ÿ£ÿ∂ŸÅ ŸÉŸÖŸäÿ© ÿ£ÿÆÿ±Ÿâ"
//                             >
//                               +
//                             </button>
//                             <span className="px-4 py-2 text-[#393405] font-semibold text-lg select-none">
//                               {getProductQuantity(product._id)}
//                             </span>
//                             <button
//                               onClick={() => removeFromCart(product._id)}
//                               className="px-4 py-2 text-[#393405] transition-colors duration-200 cursor-pointer"
//                               aria-label="ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ÿßŸÑÿ≥ŸÑÿ©"
//                             >
//                               <Trash2
//                                 size={20}
//                                 className="hover:text-red-500"
//                               />
//                             </button>
//                           </div>
//                         ) : (
//                           <button
//                             onClick={() => addToCart(product._id)}
//                             className="bg-[#fdf407] hover:bg-[#dfd93e] text-[#393405] font-semibold py-2 px-6 rounded-lg cursor-pointer flex items-center gap-2 transition-all duration-300"
//                           >
//                             ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©
//                             <span className="sm:text-lg text-base">üõí</span>
//                           </button>
//                         )}
//                       </div>
//                     </div>
//                   </div>
//                 </div>
//               );
//             })}
//           </div>

//           <button
//             className="absolute right-4 top-1/2 bg-[#fdf407] cursor-pointer -translate-y-1/2 z-10 w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-100 transition-colors duration-200"
//             onClick={nextSlide}
//             aria-label="ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ™ÿßŸÑŸä"
//           >
//             <ChevronRight className="button-icon" />
//           </button>
//           {/* Pagination indicators */}
//           <div className="flex justify-center mt-10 sm:mt-20 space-x-2">
//             {products.map((_, index) => (
//               <button
//                 key={index}
//                 onClick={() => goToSlide(index)}
//                 className={`w-3 h-3 rounded-full transition-colors duration-200 cursor-pointer
//                   ${index === currentSlide ? "bg-[#fdf407]" : "bg-gray-300"}`}
//                 aria-label={`ÿßŸÜÿ™ŸÇŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ¥ÿ±Ÿäÿ≠ÿ© ${index + 1}`}
//               />
//             ))}
//           </div>
//         </div>
//       </div>
//     </section>
//   );
// };

// export default NewProductSection;


#################################################################################################

// src/lib/mongodb.js

import mongoose from "mongoose";

const MONGODB_URI = process.env.MONGODB_URI;

if (!MONGODB_URI) {
  throw new Error("Please define the MONGODB_URI environment variable inside .env.local");
}

let cached = global.mongoose;
if (!cached) {
  cached = global.mongoose = { conn: null, promise: null };
}

export async function connectDB() {
  if (cached.conn) return cached.conn;

  if (!cached.promise) {
    cached.promise = mongoose
      .connect(MONGODB_URI, {
        dbName: "buy-tech-db",     
        useNewUrlParser: true,
        useUnifiedTopology: true,
      })
      .then((mongoose) => mongoose);
  }

  cached.conn = await cached.promise;
  return cached.conn;
}


#################################################################################################

import { clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs) {
  return twMerge(clsx(inputs));
}

#################################################################################################

import mongoose from "mongoose";

// Define nested sub-schemas for clarity and type safety
const cpuSchema = new mongoose.Schema({
  brand: String,
  model: String,
  generation: Number,
  baseClock: Number,
  boostClock: Number,
  cores: Number,
  threads: Number,
}, { _id: false });

const gpuSchema = new mongoose.Schema({
  brand: String,
  model: String,
  dedicated: Boolean,
}, { _id: false });

const ramSchema = new mongoose.Schema({
  size: Number,
  unit: String,
  type: String,
  speed: Number,
}, { _id: false });

const storageSchema = new mongoose.Schema({
  capacity: Number,
  unit: String,
  type: String,
  interface: String,
}, { _id: false });

const screenSchema = new mongoose.Schema({
  size: Number,
  unit: String,
  resolution: String,
  type: String,
  refreshRate: Number,
  antiGlare: Boolean,
}, { _id: false });

const batterySchema = new mongoose.Schema({
  capacity: Number,
  unit: String,
  cells: Number,
}, { _id: false });

const dimensionsSchema = new mongoose.Schema({
  width: Number,
  depth: Number,
  height: Number,
  unit: String,
}, { _id: false });

const specsSchema = new mongoose.Schema({
  cpu: cpuSchema,
  gpu: gpuSchema,
  ram: ramSchema,
  storage: storageSchema,
  screen: screenSchema,
  battery: batterySchema,
  os: String,
  ports: [String],
  connectivity: [String],
  weight: Number,
  dimensions: dimensionsSchema,
  keyboardLanguage: String,
  bodyMaterial: String,
  color: String,
  maxMemory: Number,
  camera: String,
  audio: String,
}, { _id: false });

const productSchema = new mongoose.Schema({
  id: String,
  name: String,
  brand: String,
  model: String,
  category: String,
  subCategory: String,
  tags: [String],
  description: String,
  image: String,
  images: [String],
  price: Number,
  discount: Number,
  stock: mongoose.Schema.Types.Mixed,
  warranty: String,
  condition: String,
  badge: String,
  releaseYear: Number,
  sku: String,
  barcode: String,
  extraFeatures: [String],
  specs: specsSchema, // ‚úÖ The correct way to embed nested schemas
}, { timestamps: true });

export default mongoose.models.Product || mongoose.model("Product", productSchema);


#################################################################################################

"use client";

import { create } from "zustand";

const useProductsStore = create((set, get) => ({
  products: [],
  loading: true,
  error: null,

  fetchProducts: async () => {
    try {
      const res = await fetch("/api/products");
      if (!res.ok) throw new Error("Failed to fetch products");
      const data = await res.json();
      set({ products: data, loading: false, error: null });
    } catch (error) {
      set({ loading: false, error: error.message });
    }
  },

  getBestSellerProducts: () => {
    const { products } = get();
    return products.filter((product) =>
      product.tags?.some((tag) => tag.includes("bestSeller"))
    );
  },

  getNewProducts: () => {
    const { products } = get();
    return products.filter((product) =>
      product.tags?.some((tag) => tag.includes("new"))
    );
  },

  ensureProductsLoaded: async () => {
    const { products, fetchProducts } = get();
    if (products.length === 0) {
      await fetchProducts();
    }
  },
}));

export default useProductsStore;

#################################################################################################

'use client';

import { useEffect } from 'react';
import useCartStore from './cartStore';
import useProductsStore from './productsStore';

function StoreInitializer() {
useEffect(() => {
  const cartStore = useCartStore.getState();
  const productsStore = useProductsStore.getState();

  cartStore.initializeCart();
  productsStore.ensureProductsLoaded();

  const unsubscribeCart = useCartStore.subscribe(
    (state) => state.cartItem,
    () => cartStore.updateCartDetails(productsStore.products)
  );

  const unsubscribeProducts = useProductsStore.subscribe(
    (state) => state.products,
    () => console.log('Products updated')
  );

  return () => {
    unsubscribeCart?.();
    unsubscribeProducts?.();
  };
}, []);

  return null;
}

export default StoreInitializer;

#################################################################################################

// src/app/api/products/route.js

import { connectDB } from "@/lib/mongoose";
import Product from "@/models/Product";

export async function GET() {
  await connectDB();
  const products = await Product.find(); 
  return new Response(JSON.stringify(products), { status: 200 });
}

export async function POST(req) {
  try {
    await connectDB();
    const data = await req.json();

    await Product.create(data);

    return Response.json({ message: "Product added successfully" }, { status: 201 });
  } catch (error) {
    console.error("POST error:", error);
    return Response.json({ error: "Failed to create product" }, { status: 500 });
  }
}

#################################################################################################


#################################################################################################


#################################################################################################


#################################################################################################


#################################################################################################


#################################################################################################


